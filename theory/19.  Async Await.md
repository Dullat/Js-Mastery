concept to make you _cry tears of clarity_.

---

# ğŸš€ 16. Async/Await

---

## 1. ğŸ’¡ **Why do we need Async/Await?**

### â¡ï¸ **Callbacks Problem**

- Callback Hell â†’ unreadable nested code
    
- Error handling scattered in each callback
    

---

### â¡ï¸ **Promises Improvement**

- Solve nesting by chaining `.then()`, `.catch()`
    
- But **complex flows** (e.g. sequential + parallel + conditions) can still be messy
    

---

### â¡ï¸ **Async/Await: Ultimate Syntactic Sugar**

âœ… Built **on top of Promises**  
âœ… Makes async code look **like synchronous code**  
âœ… Improves readability and maintainability

---

## 2. ğŸ”¥ **Basic Syntax**

```js
async function fetchData() {
  return "Data";
}

fetchData().then(console.log); // Data
```

### â¡ï¸ **Key Points**

âœ”ï¸ `async` makes a function always return a **promise**  
âœ”ï¸ If function returns value, promise resolves with it  
âœ”ï¸ If function throws error, promise rejects with it

---

### â¡ï¸ **Using `await`**

```js
async function showData() {
  const data = await fetchData();
  console.log(data);
}
```

âœ… `await` pauses function execution until the promise resolves.  
âœ… Only works **inside async functions** (except top-level await in ES2022).

---

## 3. ğŸ”‚ **Await in Loops**

### â¡ï¸ **Sequential vs Parallel Execution**

```js
const urls = ["url1", "url2", "url3"];

// Sequential: waits for each to finish
async function sequential() {
  for (const url of urls) {
    const data = await fetch(url);
    console.log(data);
  }
}

// Parallel: all at once
async function parallel() {
  const promises = urls.map(url => fetch(url));
  const results = await Promise.all(promises);
  console.log(results);
}
```

âœ… **Sequential** is simpler if order matters  
âœ… **Parallel** is faster for independent tasks

---

### âš ï¸ **Avoid await in forEach**

```js
urls.forEach(async url => {
  const data = await fetch(url);
  console.log(data);
});
```

âœ”ï¸ **Why?** `forEach` does not await the async callbacks; it returns immediately.  
âœ… Use `for...of` or `Promise.all`.

---

## 4. ğŸ› ï¸ **Error Handling**

âœ… Use try/catch with await

```js
async function getData() {
  try {
    const data = await fetch("bad_url");
    const json = await data.json();
    console.log(json);
  } catch (err) {
    console.error("Error:", err);
  }
}
```

âœ… Similar to `.catch()` in promises but cleaner in async flows.

---

### âš ï¸ **Unhandled Rejections**

If you `await` a promise that rejects and don't handle it with try/catch, it throws an uncaught error.

---

## 5. ğŸ”¬ **Top-Level Await**

### â¡ï¸ **Introduced in ES2022**

Allows `await` **outside of async functions** at the top level of ES modules.

```js
const data = await fetch("/api");
console.log(data);
```

âœ… Useful in module scripts  
âŒ Not allowed in scripts without type="module"

---

## 6. âš¡ **Async/Await vs Promises**

|Feature|Promises|Async/Await|
|---|---|---|
|Syntax|.then().catch() chaining|synchronous-like code with await|
|Readability|Can get nested in chains|Cleaner, top-down code|
|Error Handling|.catch() at end|try/catch blocks|
|Underlying Mechanism|Promise API|Built on Promises|

âœ… **Async/Await is syntactic sugar over promises**, not a replacement.

---

## 7. ğŸ§  **Advanced Gotchas**

âœ”ï¸ **Returning multiple awaits sequentially can be slow.** Use `Promise.all` when tasks are independent.

âœ”ï¸ **Async functions always return promises**, even if returning a simple value.

âœ”ï¸ **Nested awaits slow down performance if not needed.**

---

### ğŸ”¥ **Example: Combining Sequential and Parallel**

```js
async function processData() {
  const user = await getUser();

  const [posts, comments] = await Promise.all([
    getPosts(user.id),
    getComments(user.id)
  ]);

  console.log(posts, comments);
}
```

âœ… Cleanly runs user fetch sequentially, then posts/comments in parallel.

---

## 8. ğŸ¯ **Summary Table**

|Keyword|Purpose|
|---|---|
|async|Declares function returns a promise|
|await|Pauses execution until promise resolves|
|try/catch|Error handling with await|
|Top-level await|Use await outside functions (modules)|

---

## ğŸ“š **Further Reading & Practice**

- [MDN: async/await](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Asynchronous/Promises)
    
- [JavaScript.info: async/await](https://javascript.info/async-await)
    
- Build:
    
    - **Sequential image loader**
        
    - **Parallel API fetch with Promise.all**
        
    - **Race timeout with async/await + Promise.race**
        

---
